(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    127581,       3028]
NotebookOptionsPosition[    125741,       2964]
NotebookOutlinePosition[    126098,       2980]
CellTagsIndexPosition[    126055,       2977]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Try", " ", 
    RowBox[{"using", " ", ":", "http", ":"}]}], "//", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"www", ".", "wolfram", ".", "com"}], "/", "mathematica"}], "/", 
     "new"}], "-", "in", "-", 
    RowBox[{"9", "/", "advanced"}], "-", "hybrid", "-", "and", "-", 
    "differential", "-", "algebraic", "-", 
    RowBox[{"equations", "/", "billiard"}], "-", 
    RowBox[{"balls", ".", "html"}]}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.642854018513761*^9, 3.642854021854856*^9}}],

Cell[BoxData[{
 RowBox[{"WhenEvent", "   "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"or", " ", "look", " ", "up", " ", "Ray"}], "-", 
  "casting"}]}], "Input",
 CellChangeTimes->{{3.642854063744825*^9, 3.642854070687727*^9}}],

Cell[CellGroupData[{

Cell["Use Friction To control position of 2 robots.", "Subsection",
 CellChangeTimes->{{3.642115570787943*^9, 3.642115621242105*^9}}],

Cell["\<\
Assume friction is inifinite:  a robot touching top wall wil not move in x \
direction.
step 1 : manipulate that can set initial and final position of 2 robots
step 2: simulate the effect of control actions on the robots.
function : achieveDesiredXspacing
function : achieveDesiredYspacing[[
logic to choose which function to use
simulate the inputs.
\
\>", "Text",
 CellChangeTimes->{{3.642115601949304*^9, 3.642115760596417*^9}, {
  3.642149838083499*^9, 3.642149854093453*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"p", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["3", "2"]}], ",", 
      FractionBox["3", "4"]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"p", "[", 
  RowBox[{"[", "0", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6421269541522818`*^9, 3.6421269697445498`*^9}, 
   3.642127070701745*^9, 3.642127570143911*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["3", "2"]}], ",", 
     FractionBox["3", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.645208597562598*^9, 3.6452105736961317`*^9, 
  3.645276093837572*^9, 3.645276356931046*^9}],

Cell[BoxData["List"], "Output",
 CellChangeTimes->{3.645208597562598*^9, 3.6452105736961317`*^9, 
  3.645276093837572*^9, 3.6452763569385242`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "4"}], ",", 
      RowBox[{"1", "/", "4"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "/", "4"}], ",", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "4"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "1"}], "/", "4"}], ",", 
      RowBox[{
       RowBox[{"-", "1"}], "/", "4"}]}], "}"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.642127845583112*^9, 3.642127847612975*^9}}],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{3.6452085978320227`*^9, 3.645210573946142*^9, 
  3.645276094089514*^9, 3.6452763571561527`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ApplyMove", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6421567917076283`*^9, 3.642156862530005*^9}, {
   3.642618470835178*^9, 3.64261850834186*^9}, 3.6426194188844643`*^9, 
   3.642619457307364*^9, 3.642619498138268*^9, {3.642619577120837*^9, 
   3.64261959177497*^9}, {3.642619639762658*^9, 3.642619642529171*^9}, {
   3.642619749975976*^9, 3.6426197780037127`*^9}}],

Cell[BoxData[
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Indeterminate", "\[LessEqual]", "1"}], "&&", 
    RowBox[{"Indeterminate", "\[LessEqual]", "1"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Plus", "@@", 
          RowBox[{
          "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "-", 
         RowBox[{
          RowBox[{"Subtract", "@@", 
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          " ", 
          RowBox[{"Last", "[", 
           RowBox[{
           "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "]"}]}]}], ")"}]}], "&"}], ")"}], "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"First", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Indeterminate", ",", "Indeterminate"}], "}"}]}], "}"}], "]"}],
    ",", "False"}], "]"}]], "Output",
 CellChangeTimes->{3.645208597960698*^9, 3.645210574079207*^9, 
  3.645276094257525*^9, 3.645276357279138*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"segsegintersection", "[", "lines_", "]"}], ":=", 
   RowBox[{"Quiet", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"md", "=", 
          RowBox[{"Subtract", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Plus", "@@", "#"}], "&"}], "/@", "lines"}], ")"}]}]}], 
         ",", 
         RowBox[{"sub", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Subtract", "@@", "#"}], "&"}], "/@", "lines"}]}], ",", 
         "det"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"INPUTS", ":", " ", 
          RowBox[{"a", " ", "list", " ", "of", " ", "lines", "   ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "line1", "}"}], ",", " ", 
             RowBox[{"{", "line2", "}"}]}], "}"}]}]}], ",", " ", 
         RowBox[{
          RowBox[{"where", " ", "line"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x0", ",", "y0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x2", ",", "y1"}], "}"}]}], "}"}], 
           "\[IndentingNewLine]", "returns", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], " ", "intersection", " ", "point",
            " ", "if"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"det", "=", 
         RowBox[{"-", 
          RowBox[{"Det", "[", "sub", "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"And", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", "#", "]"}], "\[LessEqual]", "1"}], "&"}],
                "/@", "#"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Plus", "@@", 
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "-", 
                 RowBox[{
                  RowBox[{"Subtract", "@@", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], " ", 
                  RowBox[{"Last", "@", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}]}], ")"}], "/", "2"}], "&"}],
              "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"First", "@", "lines"}], ",", "#"}], "}"}]}], ",", 
            "False"}], "]"}], "&"}], "@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Det", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                ",", "md"}], "}"}], "]"}], "/", "det"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"Reverse", "@", "#"}]}], "}"}], "&"}], "@", "sub"}], 
            ")"}]}], ")"}]}]}]}], "]"}], ",", 
     RowBox[{"General", "::", "infy"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FindIntersectionOfsegmentWithWalls", "[", 
     RowBox[{"seg_", ",", "walls_"}], "]"}], ":=", 
    RowBox[{"First", "[", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"segsegintersection", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"seg", ",", "edge"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"edge", ",", "walls"}], "}"}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"#", "=!=", "False"}], "&"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"moveParticleInWalls", "[", 
   RowBox[{"pos_", ",", "move_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", " ", "=", " ", 
       RowBox[{
       "pos", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"y", " ", "=", " ", 
       RowBox[{
       "pos", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"moveApplied", "=", " ", 
       RowBox[{"pos", "+", "move"}]}], ",", "newPos", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"walls", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"move", ":", "  ", 
       RowBox[{"{", 
        RowBox[{"\[CapitalDelta]x", ",", " ", "\[CapitalDelta]y"}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"walls", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "list", " ", "of", " ", "line", " ", "segments", 
         "\[IndentingNewLine]", "pos"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "y"}], "}"}], " ", "position"}]}]}]}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", "  ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", "\[NotEqual]", " ", "1"}], " ", "&&", " ", 
        RowBox[{"y", "\[NotEqual]", " ", "1"}], "&&", 
        RowBox[{"x", "\[NotEqual]", " ", "0"}], " ", "&&", " ", 
        RowBox[{"y", "\[NotEqual]", " ", "0"}]}], " ", ")"}], 
      RowBox[{"(*", 
       RowBox[{"not", " ", "touching", " ", "wall"}], "*)"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "true", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
           "moveApplied", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "<", " ", "1"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{
           "moveApplied", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], ">", "0"}], " ", "&&", " ", 
          RowBox[{
           RowBox[{
           "moveApplied", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], " ", "<", "1"}], "&&", " ", 
          RowBox[{
           RowBox[{
           "moveApplied", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], ">", "0"}]}], " ", ")"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"apply", " ", "move"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newPos", " ", "=", " ", 
         RowBox[{"pos", "+", "move"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"stop", " ", "movement"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"newPos", " ", "=", " ", 
          RowBox[{"pos", "+", "move"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newPos", " ", "=", 
         RowBox[{"FindIntersectionOfsegmentWithWalls", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"pos", ",", "moveApplied"}], "}"}], ",", "walls"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"we", " ", "are", " ", "touching", " ", "the", " ", 
        RowBox[{"walls", ".", "  ", "Which"}], " ", 
        RowBox[{"wall", "?"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"newPos", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
            "move", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], ">", "0"}], "||", " ", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
            "move", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "]"}], ">", "0"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{"skip", " ", "zero", " ", "movements"}], "*)"}], ",", 
         RowBox[{"Module", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Alpha]Des", " ", ",", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"-", "\[Pi]"}], ",", "\[Pi]"}], "*)"}], 
             "\[IndentingNewLine]", "moveOK"}], " ", "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"moveOK", " ", "=", " ", "True"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"\[Alpha]Des", " ", "=", " ", 
             RowBox[{"ArcTan", "[", 
              RowBox[{
               RowBox[{
               "move", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                ",", 
               RowBox[{
               "move", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", " ", "\[Equal]", " ", "0"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "\[Alpha]Des", "]"}], "\[GreaterEqual]", 
                " ", 
                RowBox[{
                 FractionBox["\[Pi]", "2"], "-", 
                 FractionBox["1", "1000"]}]}]}], ",", " ", 
              RowBox[{"moveOK", " ", "=", " ", "False"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"x", " ", "\[Equal]", " ", "1"}], " ", "&&", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "\[Alpha]Des", "]"}], "\[LessEqual]", " ", 
                RowBox[{
                 FractionBox["\[Pi]", "2"], "+", 
                 FractionBox["1", "1000"]}]}]}], " ", ",", " ", 
              RowBox[{"moveOK", " ", "=", " ", "False"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"y", " ", "\[Equal]", " ", "1"}], " ", "&&", 
               RowBox[{"(", " ", 
                RowBox[{
                 RowBox[{"\[Alpha]Des", "\[GreaterEqual]", " ", 
                  RowBox[{"-", 
                   FractionBox["1", "1000"]}]}], " ", "||", " ", 
                 RowBox[{"\[Alpha]Des", " ", "\[LessEqual]", " ", 
                  RowBox[{
                   RowBox[{"-", "\[Pi]"}], "+", 
                   FractionBox["1", "1000"]}]}]}], " ", ")"}]}], ",", " ", 
              RowBox[{"moveOK", " ", "=", " ", "False"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"y", " ", "\[Equal]", " ", "0"}], " ", "&&", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Alpha]Des", "\[LessEqual]", " ", 
                  FractionBox["1", "1000"]}], " ", "||", " ", 
                 RowBox[{"\[Alpha]Des", " ", "\[GreaterEqual]", "  ", 
                  RowBox[{"\[Pi]", "-", 
                   FractionBox["1", "1000"]}]}]}], ")"}]}], ",", " ", 
              RowBox[{"moveOK", " ", "=", " ", "False"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"moveOK", ",", 
              RowBox[{"pos", "+", "move"}], ",", "pos"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", " ", "pos"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]"}], "Input",\

 InitializationCell->True,
 CellChangeTimes->{{3.6436330620151863`*^9, 3.643633142555245*^9}, {
   3.643634635387471*^9, 3.643634635773616*^9}, {3.64363493510086*^9, 
   3.64363493534129*^9}, {3.643635816124959*^9, 3.6436358204569397`*^9}, {
   3.6436366106330957`*^9, 3.643636617664937*^9}, {3.643636682239799*^9, 
   3.643636694974148*^9}, 3.643636729566121*^9, {3.643636902849749*^9, 
   3.6436369286741333`*^9}, {3.643637089317648*^9, 3.643637103849972*^9}, {
   3.643716442501993*^9, 3.643716447801918*^9}, {3.644132841075902*^9, 
   3.644132875554392*^9}, {3.644135900822158*^9, 3.644136104160116*^9}, {
   3.6441361375657377`*^9, 3.644136187447153*^9}, 3.6441362539073133`*^9, {
   3.644136303167753*^9, 3.644136333030587*^9}, {3.644136417928399*^9, 
   3.644136429191375*^9}, {3.644136564663416*^9, 3.644136579037611*^9}, {
   3.644151452516255*^9, 3.644151471147826*^9}, {3.6441628139359293`*^9, 
   3.644162848484384*^9}, 3.6441629225327883`*^9, {3.6441629890134354`*^9, 
   3.6441630397915125`*^9}, {3.644163419358466*^9, 3.6441634621847477`*^9}, {
   3.6441635476892977`*^9, 3.644163576769205*^9}, {3.6441636111506433`*^9, 
   3.6441636208116093`*^9}, {3.644163758897416*^9, 3.6441637667802043`*^9}, 
   3.644163879803506*^9, 3.6441639104035654`*^9, {3.6441639642099457`*^9, 
   3.6441640529068146`*^9}, {3.6441641211746407`*^9, 3.644164159420015*^9}, {
   3.644164259667015*^9, 3.644164290558015*^9}, {3.644164427862015*^9, 
   3.644164432658015*^9}, {3.644164628012015*^9, 3.6441646816260147`*^9}, 
   3.6441647491980147`*^9, {3.644164784306015*^9, 3.6441648363500147`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[NoBreak]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\[Alpha]Des", "=", 
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.02400000000000002`"}], ",", "0.`"}], "}"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.02400000000000002`"}], ",", "0.`"}], "}"}], 
        "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], "]"}]}], 
    ",", 
    RowBox[{"moveOK", "=", "True"}]}], "}"}], "\[NoBreak]"}]], "Input",
 CellChangeTimes->{3.6441635358951187`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.141592653589793`", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{3.6452085979875097`*^9, 3.645210574140291*^9, 
  3.645276094302951*^9, 3.64527635733405*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"achieveDesiredXspacing", "[", 
    RowBox[{"ps1_", ",", "ps2_", ",", "pe1_", ",", "pe2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]e", " ", ",", " ", "\[CapitalDelta]x", " ", ",", " ", 
       "L", " ", ",", " ", "\[IndentingNewLine]", "currPosTop", ",", " ", 
       "currPosBottom", ",", "\[CapitalDelta]r", ",", " ", "moves", ",", " ", 
       "endPosTop", ",", " ", "endPosBottom", ",", " ", 
       RowBox[{"my\[Epsilon]", " ", "=", " ", 
        RowBox[{"1", "/", "1000"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "determine", " ", "which", " ", "point", " ", "is", " ", "highest"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
         RowBox[{
         "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"currPosTop", " ", "=", " ", "ps1"}], ";", " ", 
         RowBox[{"currPosBottom", "=", "ps2"}], ";", 
         RowBox[{"endPosTop", " ", "=", " ", "pe1"}], ";", " ", 
         RowBox[{"endPosBottom", "=", " ", "pe2"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"currPosTop", " ", "=", " ", "ps2"}], ";", " ", 
         RowBox[{"currPosBottom", "=", "ps1"}], ";", " ", 
         RowBox[{"endPosTop", " ", "=", " ", "pe2"}], ";", " ", 
         RowBox[{"endPosBottom", "=", " ", "pe1"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]e", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "endPosTop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "-", 
        RowBox[{
        "endPosBottom", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"desired", " ", "difference"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "currPosTop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        " ", "-", " ", 
        RowBox[{
        "currPosBottom", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"current", " ", "distance"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moves", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"list", " ", "of", " ", "commanded", " ", "moves"}], ",", " ", 
        RowBox[{"in", " ", "form", " ", 
         RowBox[{"{", 
          RowBox[{"\[CapitalDelta]x", ",", " ", "\[CapitalDelta]y"}], 
          "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"L", "=", " ", "1"}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{"size", " ", "of", " ", "workspace"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<ps1 = ``, ps2 = ``, pe1= ``,pe2 = ``, \[CapitalDelta]e = ``,\
\[CapitalDelta]x = ``\>\"", ",", "ps1", ",", "ps2", ",", "pe1", ",", "pe2", 
           ",", "\[CapitalDelta]e", ",", "\[CapitalDelta]x"}], " ", "]"}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "2"}], ",", 
         RowBox[{"i", "++"}], ","}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[CapitalDelta]x", "\[Equal]", "\[CapitalDelta]e"}], ",", 
        " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
             "endPosTop", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], " ", "-", " ", 
             RowBox[{
             "currPosTop", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], " ", ",", " ", 
            RowBox[{
             RowBox[{
             "endPosTop", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], " ", "-", " ", 
             RowBox[{
             "currPosTop", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], " ", "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "moves", "]"}]}]}], "]"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"base", " ", 
        RowBox[{"case", " ", "--"}], " ", "end", " ", "the", " ", 
        "recursion"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      " ", 
      RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]e", " ", "<", " ", "0"}], ",", "  ", 
           RowBox[{"(*", "right", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "1.", " ", "move", " ", "almost", " ", "to", " ", "right", " ", 
             "wall"}], "*)"}], "\[IndentingNewLine]", " ", 
           RowBox[{"L", " ", "-", " ", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{
              "currPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], " ", ",", " ", 
              RowBox[{
              "currPosBottom", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}], "-", "my\[Epsilon]"}], ",",
            
           RowBox[{"(*", 
            RowBox[{
            "1.", " ", "move", " ", "almost", " ", "to", " ", "left", " ", 
             "wall"}], "*)"}], " ", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{
               "currPosTop", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], " ", ",", " ", 
               RowBox[{
               "currPosBottom", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "]"}]}], "+", "my\[Epsilon]"}]}],
           "]"}], ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"2.", " ", "move", " ", "to", " ", "bottom"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]r", "=", 
       RowBox[{"{", " ", 
        RowBox[{"0", ",", " ", 
         RowBox[{"-", 
          RowBox[{
          "currPosBottom", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "3.", " ", "drag", " ", "sideways", " ", "to", " ", "left", " ", "or", 
        " ", "right"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], " ", ">", 
            "0"}], " ", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], "]"}], 
             ",", " ", 
             RowBox[{"L", "-", " ", 
              RowBox[{
              "currPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], "]"}], 
              ",", " ", 
              RowBox[{
              "currPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ",", "0"}], 
        "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"4.", " ", "move", " ", "up"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"\[CapitalDelta]r", "=", 
       RowBox[{"{", " ", 
        RowBox[{"0", ",", "my\[Epsilon]"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "currPosTop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        " ", "-", " ", 
        RowBox[{
        "currPosBottom", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", "\[CapitalDelta]x", "]"}], "\[LessEqual]", " ", 
         RowBox[{"Abs", "[", 
          RowBox[{"\[CapitalDelta]e", "+", " ", "my\[Epsilon]"}], "]"}]}], 
        ",", 
        RowBox[{
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"endPosTop", "-", " ", "currPosTop"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "endPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "-", " ", 
              RowBox[{
              "currPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", "0"}], "}"}], " ", ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "moves", "]"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]e", " ", "<", " ", "0"}], ",", "  ", 
              RowBox[{"(*", "right", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "1.", " ", "move", " ", "almost", " ", "to", " ", "right", " ",
                 "wall"}], "*)"}], "\[IndentingNewLine]", " ", 
              RowBox[{"L", " ", "-", " ", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                 "currPosTop", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], " ", ",", " ", 
                 RowBox[{
                 "currPosBottom", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "-", "my\[Epsilon]"}], 
              ",", 
              RowBox[{"(*", 
               RowBox[{
               "1.", " ", "move", " ", "almost", " ", "to", " ", "left", " ", 
                "wall"}], "*)"}], " ", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{
                  "currPosTop", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], " ", ",", " ", 
                  RowBox[{
                  "currPosBottom", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "+", 
               "my\[Epsilon]"}]}], "]"}], ",", "0"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"2.", " ", "move", " ", "to", " ", "bottom"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", "=", 
          RowBox[{"{", " ", 
           RowBox[{"0", ",", " ", 
            RowBox[{"-", 
             RowBox[{
             "currPosBottom", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "3.", " ", "drag", " ", "sideways", " ", "to", " ", "left", " ", 
           "or", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], " ", 
               ">", "0"}], " ", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], "]"}],
                 ",", " ", 
                RowBox[{"L", "-", " ", 
                 RowBox[{
                 "currPosTop", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], 
                  "]"}], ",", " ", 
                 RowBox[{
                 "currPosTop", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ",", "0"}], 
           "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"4.", " ", "move", " ", "up"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", "=", 
          RowBox[{"{", " ", 
           RowBox[{"0", ",", "my\[Epsilon]"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
          RowBox[{
           RowBox[{
           "currPosTop", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], " ", "-", " ", 
           RowBox[{
           "currPosBottom", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]x", "\[Equal]", "\[CapitalDelta]e"}], 
             ",", " ", 
             RowBox[{"Return", "[", "moves", "]"}], ",", " ", 
             RowBox[{"Return", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"moves", ",", 
                RowBox[{"achieveDesiredXspacing", "[", 
                 RowBox[{
                 "currPosTop", ",", "currPosBottom", ",", " ", "pe1", ",", 
                  "pe2"}], "]"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"endPosTop", "-", " ", "currPosTop"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "endPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "-", " ", 
              RowBox[{
              "currPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", "0"}], "}"}], " ", ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "moves", "]"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6441627135478916`*^9, 3.644162715892126*^9}, {
   3.644733583678694*^9, 3.644733677893701*^9}, {3.6447337931494827`*^9, 
   3.644733795996591*^9}, {3.6447339910539827`*^9, 3.644733993778543*^9}, {
   3.644734038299387*^9, 3.64473403878435*^9}, {3.6447340790983*^9, 
   3.644734092497757*^9}, {3.644734174741228*^9, 3.64473428094261*^9}, {
   3.644734359612055*^9, 3.6447343678749313`*^9}, {3.644734564462376*^9, 
   3.644734567476335*^9}, {3.644735102932693*^9, 3.6447351331886806`*^9}, {
   3.644735213418202*^9, 3.644735217225874*^9}, {3.644735278173078*^9, 
   3.644735298277915*^9}, {3.644735406315185*^9, 3.6447354766022377`*^9}, {
   3.6447355423733177`*^9, 3.64473557064137*^9}, 3.6447356356775208`*^9, {
   3.644735674993661*^9, 3.6447356787746572`*^9}, {3.6447357793932047`*^9, 
   3.644735779614152*^9}, {3.644736081960328*^9, 3.6447361074197817`*^9}, {
   3.644736151862186*^9, 3.644736173678362*^9}, 3.644736239672566*^9, {
   3.644736637418436*^9, 3.644736682821549*^9}, {3.64473673727947*^9, 
   3.644736815033558*^9}, {3.644736887451696*^9, 3.644736889832197*^9}, 
   3.644736935884053*^9, {3.644737346566967*^9, 3.644737416895726*^9}, 
   3.644737447945651*^9, {3.644737636372819*^9, 3.6447376444923067`*^9}, {
   3.6447376868771*^9, 3.6447377056250343`*^9}, {3.644737757006197*^9, 
   3.6447378787323647`*^9}, {3.644737993199691*^9, 3.644738020959515*^9}, {
   3.644738458344193*^9, 3.644738497437456*^9}, {3.644738528250764*^9, 
   3.6447385389058237`*^9}, {3.64473857842772*^9, 3.644738664183977*^9}, {
   3.644739255063458*^9, 3.6447393050249662`*^9}, {3.644739397120481*^9, 
   3.644739432267178*^9}, {3.6447608449821663`*^9, 3.644760878050829*^9}, {
   3.644760951083593*^9, 3.6447609954427767`*^9}, {3.6447611724607077`*^9, 
   3.644761176227539*^9}, {3.644762048539816*^9, 3.6447620508214703`*^9}, {
   3.644762231052862*^9, 3.644762246609239*^9}, {3.644762725793542*^9, 
   3.6447627570807457`*^9}, {3.645275921477242*^9, 3.645275948329496*^9}, {
   3.645276002535152*^9, 3.645276084543193*^9}, {3.645276299196101*^9, 
   3.645276349462367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"achieveDesiredYspacing", "[", 
    RowBox[{"ps1_", ",", "ps2_", ",", "pe1_", ",", "pe2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]e", " ", ",", " ", "\[CapitalDelta]y", " ", ",", " ", 
       "L", " ", ",", " ", "\[IndentingNewLine]", "currPosRight", ",", " ", 
       "currPosLeft", ",", "\[CapitalDelta]r", ",", " ", "moves", ",", " ", 
       "endPosRight", ",", " ", "endPosLeft", ",", " ", 
       RowBox[{"my\[Epsilon]", " ", "=", " ", 
        RowBox[{"1", "/", "1000"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "determine", " ", "which", " ", "point", " ", "is", " ", "rightest"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "ps1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">", 
         RowBox[{
         "ps2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"currPosRight", " ", "=", " ", "ps1"}], ";", " ", 
         RowBox[{"currPosLeft", "=", "ps2"}], ";", 
         RowBox[{"endPosRight", " ", "=", " ", "pe1"}], ";", " ", 
         RowBox[{"endPosLeft", "=", " ", "pe2"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"currPosRight", " ", "=", " ", "ps2"}], ";", " ", 
         RowBox[{"currPosLeft", "=", "ps1"}], ";", " ", 
         RowBox[{"endPosRight", " ", "=", " ", "pe2"}], ";", " ", 
         RowBox[{"endPosLeft", "=", " ", "pe1"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]e", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "endPosRight", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
         "-", 
        RowBox[{
        "endPosLeft", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"desired", " ", "difference"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"\[CapitalDelta]y", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "currPosRight", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], " ", "-", " ", 
        RowBox[{
        "currPosLeft", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"current", " ", "distance"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moves", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"list", " ", "of", " ", "commanded", " ", "moves"}], ",", " ", 
        RowBox[{"in", " ", "form", " ", 
         RowBox[{"{", 
          RowBox[{"\[CapitalDelta]x", ",", " ", "\[CapitalDelta]y"}], 
          "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"L", "=", " ", "1"}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{"size", " ", "of", " ", "workspace"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<ps1 = ``, ps2 = ``, pe1= ``,pe2 = ``, \[CapitalDelta]e = ``,\
\[CapitalDelta]x = ``\>\"", ",", "ps1", ",", "ps2", ",", "pe1", ",", "pe2", 
           ",", "\[CapitalDelta]e", ",", "\[CapitalDelta]x"}], " ", "]"}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "2"}], ",", 
         RowBox[{"i", "++"}], ","}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[CapitalDelta]y", "\[Equal]", "\[CapitalDelta]e"}], ",", 
        " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"endPosRight", "-", " ", "currPosRight"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "moves", "]"}]}]}], "]"}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"base", " ", 
        RowBox[{"case", " ", "--"}], " ", "end", " ", "the", " ", 
        "recursion"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      " ", 
      RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", " ", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"\[CapitalDelta]e", " ", "<", " ", "0"}], ",", "  ", 
           RowBox[{"(*", "right", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "1.", " ", "move", " ", "almost", " ", "to", " ", "up", " ", 
             "wall"}], "*)"}], "\[IndentingNewLine]", " ", 
           RowBox[{"L", " ", "-", " ", 
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{
              "currPosRight", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], " ", ",", " ", 
              RowBox[{
              "currPosLeft", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}], "-", "my\[Epsilon]"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "1.", " ", "move", " ", "almost", " ", "to", " ", "down", " ", 
             "wall"}], "*)"}], " ", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{
               "currPosRight", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], " ", ",", " ", 
               RowBox[{
               "currPosLeft", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}]}], "]"}]}], "+", "my\[Epsilon]"}]}],
           "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"2.", " ", "move", " ", "to", " ", "left"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]r", "=", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
          "currPosLeft", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "3.", " ", "drag", " ", "sideways", " ", "to", " ", "left", " ", "or", 
        " ", "right"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      
      RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]y"}], " ", ">", 
            "0"}], " ", ",", 
           RowBox[{"Min", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]y"}], "]"}], 
             ",", " ", 
             RowBox[{"L", "-", " ", 
              RowBox[{
              "currPosRight", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]y"}], "]"}], 
              ",", " ", 
              RowBox[{
              "currPosRight", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"4.", " ", "move", " ", "right"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]r", "=", 
       RowBox[{"{", " ", 
        RowBox[{"my\[Epsilon]", ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]y", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "currPosRight", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}], " ", "-", " ", 
        RowBox[{
        "currPosLeft", "\[LeftDoubleBracket]", "2", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[CapitalDelta]x", "\[Equal]", "\[CapitalDelta]e"}], ",", 
          " ", 
          RowBox[{"Return", "[", "moves", "]"}], ",", " ", 
          RowBox[{"Return", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"moves", ",", 
             RowBox[{"achieveDesiredXspacing", "[", 
              RowBox[{
              "currPosTop", ",", "currPosBottom", ",", " ", "pe1", ",", 
               "pe2"}], "]"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
       RowBox[{"endPosRight", "-", " ", "currPosRight"}]}], " ", ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
      RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "moves", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.644739444646817*^9, 3.644739872658442*^9}, {
   3.644739903795951*^9, 3.64473994033882*^9}, {3.6447402464445477`*^9, 
   3.644740249730906*^9}, 3.644761871347247*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"achieveDesiredSpacing", "[", 
    RowBox[{"ps1_", ",", "ps2_", ",", "pe1_", ",", "pe2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]e", " ", ",", "\[CapitalDelta]ey", ",", " ", 
       "\[CapitalDelta]x", " ", ",", "\[CapitalDelta]y", ",", " ", "L", " ", 
       ",", " ", "\[IndentingNewLine]", "currPosTop", ",", " ", 
       "currPosBottom", ",", "currPosRight", ",", "currPosLeft", ",", 
       "\[CapitalDelta]r", ",", " ", "moves", ",", " ", "endPosTop", ",", " ",
        "endPosBottom", ",", "endPosRight", ",", " ", "endPosLeft", ",", " ", 
       
       RowBox[{"my\[Epsilon]", " ", "=", " ", 
        RowBox[{"1", "/", "1000"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "determine", " ", "which", " ", "point", " ", "is", " ", "highest"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
         RowBox[{
         "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",",
         " ", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"currPosTop", " ", "=", " ", "ps1"}], ";", " ", 
         RowBox[{"currPosBottom", "=", "ps2"}], ";", 
         RowBox[{"endPosTop", " ", "=", " ", "pe1"}], ";", " ", 
         RowBox[{"endPosBottom", "=", " ", "pe2"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"currPosTop", " ", "=", " ", "ps2"}], ";", " ", 
         RowBox[{"currPosBottom", "=", "ps1"}], ";", " ", 
         RowBox[{"endPosTop", " ", "=", " ", "pe2"}], ";", " ", 
         RowBox[{"endPosBottom", "=", " ", "pe1"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]e", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "endPosTop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "-", 
        RowBox[{
        "endPosBottom", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"desired", " ", "difference"}], "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "currPosTop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        " ", "-", " ", 
        RowBox[{
        "currPosBottom", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"current", " ", "distance"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"moves", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"list", " ", "of", " ", "commanded", " ", "moves"}], ",", " ", 
        RowBox[{"in", " ", "form", " ", 
         RowBox[{"{", 
          RowBox[{"\[CapitalDelta]x", ",", " ", "\[CapitalDelta]y"}], 
          "}"}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"L", "=", " ", "1"}], ";", "  ", 
      RowBox[{"(*", 
       RowBox[{"size", " ", "of", " ", "workspace"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"StringForm", "[", 
          RowBox[{
          "\"\<ps1 = ``, ps2 = ``, pe1= ``,pe2 = ``, \[CapitalDelta]e = ``,\
\[CapitalDelta]x = ``\>\"", ",", "ps1", ",", "ps2", ",", "pe1", ",", "pe2", 
           ",", "\[CapitalDelta]e", ",", "\[CapitalDelta]x"}], " ", "]"}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "4"}], ",", 
         RowBox[{"i", "++"}], ","}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[CapitalDelta]x", "\[Equal]", "\[CapitalDelta]e"}], ",", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "determine", " ", "which", " ", "point", " ", "is", " ", 
          "rightest"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "currPosTop", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ">", 
            RowBox[{
            "currPosBottom", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ",", " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"currPosRight", " ", "=", " ", "currPosTop"}], ";", " ", 
            RowBox[{"currPosLeft", "=", "currPosBottom"}], ";", 
            RowBox[{"endPosRight", " ", "=", " ", "pe1"}], ";", " ", 
            RowBox[{"endPosLeft", "=", " ", "pe2"}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"currPosRight", " ", "=", " ", "currPosBottom"}], ";", 
            " ", 
            RowBox[{"currPosLeft", "=", "currPosTop"}], ";", " ", 
            RowBox[{"endPosRight", " ", "=", " ", "pe2"}], ";", " ", 
            RowBox[{"endPosLeft", "=", " ", "pe1"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]ey", " ", "=", " ", 
          RowBox[{
           RowBox[{
           "endPosRight", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "-", 
           RowBox[{
           "endPosLeft", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}]}], ";", " ", 
         RowBox[{"(*", 
          RowBox[{"desired", " ", "difference"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]y", " ", "=", " ", 
          RowBox[{
           RowBox[{
           "currPosRight", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], " ", "-", " ", 
           RowBox[{
           "currPosLeft", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}]}], ";", " ", 
         RowBox[{"(*", 
          RowBox[{"current", " ", "distance"}], "*)"}], "\[IndentingNewLine]",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"StringForm", "[", 
             RowBox[{
             "\"\<ps1 = ``, ps2 = ``, pe1= ``,pe2 = ``, \[CapitalDelta]e = \
``,\[CapitalDelta]x = ``\>\"", ",", "ps1", ",", "ps2", ",", "pe1", ",", "pe2",
               ",", "\[CapitalDelta]e", ",", "\[CapitalDelta]x"}], " ", "]"}],
             "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", "2"}], ",", 
            RowBox[{"i", "++"}], ","}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[CapitalDelta]y", "\[Equal]", "\[CapitalDelta]ey"}], ",",
            " ", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
             RowBox[{"endPosRight", "-", " ", "currPosRight"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
            RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
            RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "moves", "]"}]}]}], "]"}], ";", " ", 
         RowBox[{"(*", 
          RowBox[{"base", " ", 
           RowBox[{"case", " ", "--"}], " ", "end", " ", "the", " ", 
           "recursion"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]ey", " ", "<", " ", "0"}], ",", "  ", 
              RowBox[{"(*", "right", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "1.", " ", "move", " ", "almost", " ", "to", " ", "up", " ", 
                "wall"}], "*)"}], "\[IndentingNewLine]", " ", 
              RowBox[{"L", " ", "-", " ", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                 "currPosRight", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], " ", ",", " ", 
                 RowBox[{
                 "currPosLeft", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}], "-", "my\[Epsilon]"}], 
              ",", 
              RowBox[{"(*", 
               RowBox[{
               "1.", " ", "move", " ", "almost", " ", "to", " ", "down", " ", 
                "wall"}], "*)"}], " ", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{
                  "currPosRight", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], " ", ",", " ", 
                  RowBox[{
                  "currPosLeft", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "+", 
               "my\[Epsilon]"}]}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"2.", " ", "move", " ", "to", " ", "left"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", "=", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
             "currPosLeft", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", "0"}], "}"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "3.", " ", "drag", " ", "sideways", " ", "to", " ", "left", " ", 
           "or", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]ey", "-", "\[CapitalDelta]y"}], " ", 
               ">", "0"}], " ", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"\[CapitalDelta]ey", "-", "\[CapitalDelta]y"}], 
                 "]"}], ",", " ", 
                RowBox[{"L", "-", " ", 
                 RowBox[{
                 "currPosRight", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"\[CapitalDelta]ey", "-", "\[CapitalDelta]y"}], 
                  "]"}], ",", " ", 
                 RowBox[{
                 "currPosRight", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}]}], "}"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"4.", " ", "move", " ", "right"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", "=", 
          RowBox[{"{", " ", 
           RowBox[{"my\[Epsilon]", ",", "0"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]y", " ", "=", " ", 
          RowBox[{
           RowBox[{
           "currPosRight", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], " ", "-", " ", 
           RowBox[{
           "currPosLeft", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]x", "\[Equal]", "\[CapitalDelta]e"}], 
             ",", " ", 
             RowBox[{"Return", "[", "moves", "]"}], ",", " ", 
             RowBox[{"Return", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"moves", ",", 
                RowBox[{"achieveDesiredXspacing", "[", 
                 RowBox[{
                 "currPosTop", ",", "currPosBottom", ",", " ", "pe1", ",", 
                  "pe2"}], "]"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
           "\[CapitalDelta]y", " ", "\[Equal]", " ", "\[CapitalDelta]ey"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
             RowBox[{"endPosRight", "-", " ", "currPosRight"}]}], " ", ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
            RowBox[{"currPosRight", "+=", "\[CapitalDelta]r"}], ";", " ", 
            RowBox[{"currPosLeft", "+=", "\[CapitalDelta]r"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"Return", "[", "moves", "]"}]}]}], "]"}], ";"}], ",", " ", 
        RowBox[{"(*", 
         RowBox[{"base", " ", 
          RowBox[{"case", " ", "--"}], " ", "end", " ", "the", " ", 
          "recursion"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
         " ", 
        RowBox[{
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{"\[CapitalDelta]e", " ", "<", " ", "0"}], ",", "  ", 
              RowBox[{"(*", "right", "*)"}], "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
               "1.", " ", "move", " ", "almost", " ", "to", " ", "right", " ",
                 "wall"}], "*)"}], "\[IndentingNewLine]", " ", 
              RowBox[{"L", " ", "-", " ", 
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                 "currPosTop", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], " ", ",", " ", 
                 RowBox[{
                 "currPosBottom", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "-", "my\[Epsilon]"}], 
              ",", 
              RowBox[{"(*", 
               RowBox[{
               "1.", " ", "move", " ", "almost", " ", "to", " ", "left", " ", 
                "wall"}], "*)"}], " ", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{
                  "currPosTop", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], " ", ",", " ", 
                  RowBox[{
                  "currPosBottom", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "+", 
               "my\[Epsilon]"}]}], "]"}], ",", "0"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"2.", " ", "move", " ", "to", " ", "bottom"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", "=", 
          RowBox[{"{", " ", 
           RowBox[{"0", ",", " ", 
            RowBox[{"-", 
             RowBox[{
             "currPosBottom", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "3.", " ", "drag", " ", "sideways", " ", "to", " ", "left", " ", 
           "or", " ", "right"}], "*)"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], " ", 
               ">", "0"}], " ", ",", 
              RowBox[{"Min", "[", 
               RowBox[{
                RowBox[{"Abs", "[", 
                 RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], "]"}],
                 ",", " ", 
                RowBox[{"L", "-", " ", 
                 RowBox[{
                 "currPosTop", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"\[CapitalDelta]e", "-", "\[CapitalDelta]x"}], 
                  "]"}], ",", " ", 
                 RowBox[{
                 "currPosTop", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ",", "0"}], 
           "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"4.", " ", "move", " ", "up"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", "=", 
          RowBox[{"{", " ", 
           RowBox[{"0", ",", "my\[Epsilon]"}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";", " ", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
          RowBox[{
           RowBox[{
           "currPosTop", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], " ", "-", " ", 
           RowBox[{
           "currPosBottom", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"\[CapitalDelta]x", "\[Equal]", "\[CapitalDelta]e"}], 
             ",", " ", 
             RowBox[{"Return", "[", "moves", "]"}], ",", " ", 
             RowBox[{"Return", "[", 
              RowBox[{"Join", "[", 
               RowBox[{"moves", ",", 
                RowBox[{"achieveDesiredXspacing", "[", 
                 RowBox[{
                 "currPosTop", ",", "currPosBottom", ",", " ", "pe1", ",", 
                  "pe2"}], "]"}]}], "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
          RowBox[{"endPosTop", "-", " ", "currPosTop"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "endPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "-", " ", 
              RowBox[{
              "currPosTop", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", "0"}], "}"}], " ", ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
         RowBox[{"currPosTop", "+=", "\[CapitalDelta]r"}], ";", " ", 
         RowBox[{"currPosBottom", "+=", "\[CapitalDelta]r"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.644763065830995*^9, 3.644763112021017*^9}, {
   3.644763180482415*^9, 3.644763318931458*^9}, {3.6447633527684507`*^9, 
   3.644763413917815*^9}, {3.6447635003729477`*^9, 3.6447635470328617`*^9}, {
   3.644763714514248*^9, 3.644763748808528*^9}, {3.64476381083372*^9, 
   3.644763812168548*^9}, 3.644764013147565*^9, {3.644764099644246*^9, 
   3.644764102931425*^9}, {3.644764318970303*^9, 3.644764325656385*^9}, {
   3.645208582035589*^9, 3.645208594098624*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ArcTan", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.28`"}], ",", "0.`"}], "}"}], "\[LeftDoubleBracket]", 
    "1", "\[RightDoubleBracket]"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.28`"}], ",", "0.`"}], "}"}], "\[LeftDoubleBracket]", 
    "2", "\[RightDoubleBracket]"}]}], "]"}]], "Input"],

Cell[BoxData["3.141592653589793`"], "Output",
 CellChangeTimes->{3.645208598070047*^9, 3.645210574220999*^9, 
  3.6452760943895082`*^9, 3.6452763574190474`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ApplyMove", "[", 
     RowBox[{"p_", ",", "mv_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "inter", "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mv", "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", "p", ",", 
        RowBox[{
         RowBox[{"inter", " ", "=", " ", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"segsegintersection", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"p", ",", 
                   RowBox[{"p", "+", "mv"}]}], "}"}], ",", "edge"}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"edge", ",", " ", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
                "}"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"#", "=!=", "False"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "inter", "]"}], "<", "1"}], ",", 
           RowBox[{"p", "+", "mv"}], ",", 
           RowBox[{
           "inter", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", " ", "[", " ", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{
           "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "mv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "]"}], "<", "1"}], " ", "&&", "  ", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{
           "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "+", 
           RowBox[{
           "mv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
          "]"}], "<", "1"}]}], ",", 
       RowBox[{"p", "+", "mv"}], ",", "\[IndentingNewLine]", 
       RowBox[{"p", "+", 
        RowBox[{"mv", "*", 
         RowBox[{"Min", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", 
                 RowBox[{
                 "p", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{
                "mv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]],
                ">", "0"}], ",", 
              FractionBox[
               RowBox[{"1", "-", 
                RowBox[{
                "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               RowBox[{
               "mv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]], 
              ",", "\[Infinity]"}], "]"}], ",", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{
                 "p", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{
                "mv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]],
                ">", "0"}], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "1"}], "-", 
                RowBox[{
                "p", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               RowBox[{
               "mv", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]], 
              ",", "\[Infinity]"}], "]"}], ",", 
            RowBox[{"If", "[", " ", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", 
                 RowBox[{
                 "p", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{
                "mv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]],
                ">", "0"}], ",", 
              FractionBox[
               RowBox[{"1", "-", 
                RowBox[{
                "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
               RowBox[{
               "mv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
              ",", "\[Infinity]"}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{
                 "p", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], 
                RowBox[{
                "mv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]],
                ">", "0"}], ",", 
              FractionBox[
               RowBox[{
                RowBox[{"-", "1"}], "-", 
                RowBox[{
                "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
               RowBox[{
               "mv", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]], 
              ",", "\[Infinity]"}], "]"}]}], "}"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "find", " ", "intersection", " ", "of", " ", "of", " ", "line", " ", 
      "from", " ", "p", " ", "to", " ", "p"}], "+", 
     RowBox[{
      RowBox[{"mv", ".", "  ", "Crop"}], " ", "move", " ", "at", " ", "this", 
      " ", "point"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "path", ",", " ", "pm1", ",", "pm2", ",", "mv", ",", 
         "\[CapitalDelta]xy", " ", ",", "path1", ",", "path2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"path", "=", " ", 
          RowBox[{"achieveDesiredSpacing", "[", 
           RowBox[{"ps1", ",", "ps2", ",", "pe1", ",", "pe2"}], "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"path", " ", "=", " ", 
         RowBox[{"achieveDesiredYspacing", "[", 
          RowBox[{"ps1", ",", "ps2", ",", "pe1", ",", "pe2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{".5", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".2"}], ",", 
              RowBox[{"-", ".8"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", ".6"}], ",", ".3"}], "}"}]}], "}"}], ";"}], "*)"}],
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"Black", ",", " ", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.1"}], 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}], ",", 
             RowBox[{"1.1", 
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "White", ",", " ", 
           RowBox[{"Rectangle", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PointSize", "[", "Large", "]"}], ",", 
           "\[IndentingNewLine]", "Green", ",", 
           RowBox[{"Point", "@", "ps1"}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{"ps2", ",", 
             RowBox[{"1", "/", "20"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "Red", ",", 
           RowBox[{"Point", "@", "pe1"}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{"pe2", ",", 
             RowBox[{"1", "/", "20"}]}], "]"}], ",", "\[IndentingNewLine]", 
           "Blue", ",", 
           RowBox[{"{", " ", 
            RowBox[{"Dashed", ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"ps1", ",", "pe1"}], "}"}], "]"}], ",", 
             RowBox[{"Line", "[", 
              RowBox[{"{", 
               RowBox[{"ps2", ",", "pe2"}], "}"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"desired\[CapitalDelta]x", " ", "=", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "pe1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                 "-", 
                RowBox[{
                "ps1", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ")"}], "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "pe2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                 "-", 
                RowBox[{
                "ps2", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Text", "[", 
             RowBox[{"desired\[CapitalDelta]x", ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "Magenta", ",", 
           RowBox[{"Text", "[", 
            RowBox[{"path", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", ".5"}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Arrow", "[", 
            RowBox[{"Accumulate", "[", "path", "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"\[CapitalDelta]xy", " ", "=", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"pm1", " ", "=", " ", "ps1"}], ";", " ", 
            RowBox[{"(*", 
             RowBox[{"pm1", " ", "=", " ", 
              RowBox[{
              "the", " ", "position", " ", "of", " ", "the", " ", "particle", 
               " ", "after", " ", "the", " ", "movement", " ", "sequence"}]}],
              "*)"}], "\[IndentingNewLine]", 
            RowBox[{"pm2", " ", "=", " ", "ps2"}], ";", "\[IndentingNewLine]", 
            RowBox[{"path1", " ", "=", " ", 
             RowBox[{"{", "pm1", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"path2", " ", "=", " ", 
             RowBox[{"{", "pm2", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "<=", 
               RowBox[{"progress", "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Length", "[", "path", "]"}], "-", "1"}], ")"}]}]}],
               ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"mv", " ", "=", " ", 
                RowBox[{"path", "\[LeftDoubleBracket]", 
                 RowBox[{"i", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"pm1", "=", 
                RowBox[{"moveParticleInWalls", "[", 
                 RowBox[{"pm1", ",", "mv"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"pm2", "=", 
                RowBox[{"moveParticleInWalls", "[", 
                 RowBox[{"pm2", ",", "mv"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"path1", ",", "pm1"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"path2", ",", "pm2"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"\[CapitalDelta]xy", " ", "=", 
                RowBox[{"\[CapitalDelta]xy", " ", "+", "mv"}]}]}]}], "]"}], 
            ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "<", 
               RowBox[{"Length", "[", "path", "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"mv", " ", "=", "  ", 
                RowBox[{
                 RowBox[{"FractionalPart", "[", 
                  RowBox[{"progress", "*", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", "path", "]"}], "-", "1"}], ")"}]}],
                   "]"}], "*", 
                 RowBox[{"path", "\[LeftDoubleBracket]", 
                  RowBox[{"2", "+", 
                   RowBox[{"Floor", "[", 
                    RowBox[{"progress", "*", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", "path", "]"}], "-", "1"}], ")"}]}],
                     "]"}]}], "\[RightDoubleBracket]"}]}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"\[CapitalDelta]xy", "  ", "=", 
                RowBox[{"\[CapitalDelta]xy", " ", "+", "mv"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{"mv", ",", 
                  RowBox[{"\[CapitalDelta]xy", " ", "+", "mv"}]}], "}"}], 
                "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"pm1", "=", 
                RowBox[{"moveParticleInWalls", "[", 
                 RowBox[{"pm1", ",", "mv"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"pm2", "=", 
                RowBox[{"moveParticleInWalls", "[", 
                 RowBox[{"pm2", ",", "mv"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"path1", ",", "pm1"}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"path2", ",", "pm2"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Point", "[", "\[CapitalDelta]xy", "]"}]}], ",", 
           "\[IndentingNewLine]", "Blue", ",", 
           RowBox[{"Point", "@", 
            RowBox[{"{", "pm1", " ", "}"}]}], ",", 
           RowBox[{"Circle", "[", 
            RowBox[{"pm2", ",", 
             RowBox[{"1", "/", "20"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Arrow", "[", "path1", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Arrow", "[", "path2", "]"}]}], "\[IndentingNewLine]", 
          "}"}], "]"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"progress", ",", "Slider", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ps1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"3", "/", "4"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "Locator"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ps2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"2", "/", "3"}], ",", 
           RowBox[{"1", "/", "4"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "Locator"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pe1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "4"}], ",", 
           RowBox[{"1", "/", "2"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "Locator"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pe2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", "5"}], ",", 
           RowBox[{"1", "/", "4"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}], ",", "Locator"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642115739423017*^9, 3.64211581465235*^9}, {
   3.64211639741261*^9, 3.6421164758259487`*^9}, {3.642116679890699*^9, 
   3.642116758410285*^9}, {3.6421167981616297`*^9, 3.6421168005846863`*^9}, {
   3.6421168336329927`*^9, 3.642116921518705*^9}, {3.6421169823382807`*^9, 
   3.642116983152133*^9}, {3.642117314830017*^9, 3.642117358348731*^9}, {
   3.6421174072466583`*^9, 3.642117409374476*^9}, {3.642124222434638*^9, 
   3.6421242442884417`*^9}, {3.6421243385112267`*^9, 3.6421244210821247`*^9}, 
   3.642124523498645*^9, {3.642124676308289*^9, 3.642124683116325*^9}, {
   3.642125072402566*^9, 3.6421250781572533`*^9}, {3.64212576654256*^9, 
   3.6421257904209137`*^9}, {3.6421262438727493`*^9, 3.642126438347135*^9}, {
   3.642126473201676*^9, 3.642126691985259*^9}, {3.642126756223467*^9, 
   3.642126835554819*^9}, {3.642126903107435*^9, 3.6421270025176773`*^9}, {
   3.642127038488562*^9, 3.642127046758442*^9}, {3.642127084238357*^9, 
   3.642127157246695*^9}, {3.642127204262809*^9, 3.642127209690259*^9}, {
   3.642127246954884*^9, 3.642127319781328*^9}, {3.642127385409954*^9, 
   3.6421274168238363`*^9}, {3.642127450642715*^9, 3.642127641204687*^9}, {
   3.6421277041053133`*^9, 3.642127718788436*^9}, {3.642127753056759*^9, 
   3.642127798980464*^9}, {3.642128036054687*^9, 3.6421280553374*^9}, {
   3.6421281050166693`*^9, 3.642128105398498*^9}, {3.64212814939351*^9, 
   3.642128178070827*^9}, {3.64212821189336*^9, 3.642128212659091*^9}, {
   3.642128269261517*^9, 3.6421284306116743`*^9}, {3.6421284878824368`*^9, 
   3.6421284882264833`*^9}, {3.6421558100467997`*^9, 3.642155974360018*^9}, {
   3.642156005232833*^9, 3.6421560422645197`*^9}, {3.642156076622274*^9, 
   3.642156083901799*^9}, {3.642156159241228*^9, 3.642156167623939*^9}, {
   3.6421562340406713`*^9, 3.642156294844129*^9}, {3.6421563252443743`*^9, 
   3.642156370664515*^9}, {3.64215644238334*^9, 3.6421564495985622`*^9}, {
   3.642156610906487*^9, 3.642156642063321*^9}, {3.64215667331456*^9, 
   3.64215677514955*^9}, {3.642156866886153*^9, 3.642156881402115*^9}, {
   3.6426182910941057`*^9, 3.642618384108675*^9}, 3.6426185170327682`*^9, {
   3.642618596294671*^9, 3.642618676789468*^9}, 3.6426187498891*^9, {
   3.642619321622118*^9, 3.642619346102807*^9}, {3.6426193968470793`*^9, 
   3.642619400774208*^9}, {3.642619435907682*^9, 3.642619559541754*^9}, 
   3.642619622594232*^9, {3.642619662250639*^9, 3.642619699344433*^9}, {
   3.643635854128748*^9, 3.643635868694798*^9}, {3.6436359858043203`*^9, 
   3.643636007806951*^9}, {3.6436360427518253`*^9, 3.6436361014379253`*^9}, {
   3.643636139982049*^9, 3.643636142124593*^9}, {3.643636212796832*^9, 
   3.6436362295152683`*^9}, {3.6436363305505466`*^9, 
   3.6436363343252077`*^9}, {3.643637348632453*^9, 3.643637351110564*^9}, {
   3.6436373946838284`*^9, 3.6436374194702587`*^9}, {3.643637475920896*^9, 
   3.643637631201536*^9}, {3.6436376728431387`*^9, 3.643637810362781*^9}, {
   3.643716063430435*^9, 3.643716074988155*^9}, {3.6440855797760553`*^9, 
   3.644085597159823*^9}, {3.644085952794071*^9, 3.644086013120738*^9}, {
   3.6441327364945993`*^9, 3.644132785376173*^9}, {3.644132921016861*^9, 
   3.644132974993626*^9}, {3.644133078651518*^9, 3.644133083085525*^9}, {
   3.644733181518611*^9, 3.644733186240388*^9}, {3.644733244614622*^9, 
   3.644733245734027*^9}, {3.644737241297286*^9, 3.644737267757646*^9}, {
   3.644737528788254*^9, 3.644737547458057*^9}, {3.644738706620455*^9, 
   3.644738706802505*^9}, {3.644738988749949*^9, 3.644738989620544*^9}, {
   3.644739999988098*^9, 3.6447400301535263`*^9}, {3.644740196387375*^9, 
   3.6447402186508904`*^9}, {3.644760554867786*^9, 3.6447606000812187`*^9}, {
   3.644760782174836*^9, 3.6447608020054607`*^9}, {3.6447608936062927`*^9, 
   3.6447609010912933`*^9}, {3.64476178519411*^9, 3.644761797560363*^9}, {
   3.644761973004347*^9, 3.64476197366735*^9}, {3.644762290803269*^9, 
   3.644762291503882*^9}, {3.644762535037574*^9, 3.644762543813292*^9}, {
   3.6447626556871557`*^9, 3.644762657221249*^9}, {3.644762836059572*^9, 
   3.644762836920858*^9}, {3.644762882322543*^9, 3.644762892833354*^9}, {
   3.6447635709219847`*^9, 3.6447635785360126`*^9}, {3.6447643539946547`*^9, 
   3.644764361393894*^9}, {3.645207815626933*^9, 3.645207816711523*^9}, {
   3.6452087647423077`*^9, 3.6452087724522867`*^9}, 3.6452088789501963`*^9, {
   3.649503926109869*^9, 3.649503929104513*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pe1$$ = {
     Rational[1, 4], 
     Rational[1, 2]}, $CellContext`pe2$$ = {
     Rational[1, 5], 
     Rational[1, 4]}, $CellContext`progress$$ = 0., $CellContext`ps1$$ = {
     Rational[3, 4], 
     Rational[1, 2]}, $CellContext`ps2$$ = {
     Rational[2, 3], 
     Rational[1, 4]}, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`progress$$], 0, 1}, {{
       Hold[$CellContext`ps1$$], {
        Rational[3, 4], 
        Rational[1, 2]}}, {-1, -1}, {1, 1}}, {{
       Hold[$CellContext`ps2$$], {
        Rational[2, 3], 
        Rational[1, 4]}}, {-1, -1}, {1, 1}}, {{
       Hold[$CellContext`pe1$$], {
        Rational[1, 4], 
        Rational[1, 2]}}, {-1, -1}, {1, 1}}, {{
       Hold[$CellContext`pe2$$], {
        Rational[1, 5], 
        Rational[1, 4]}}, {-1, -1}, {1, 1}}}, Typeset`size$$ = {
    360., {120., 124.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`progress$15179$$ = 
    0, $CellContext`ps1$15180$$ = {0, 0}, $CellContext`ps2$15181$$ = {0, 
    0}, $CellContext`pe1$15182$$ = {0, 0}, $CellContext`pe2$15183$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`pe1$$ = {
          Rational[1, 4], 
          Rational[1, 2]}, $CellContext`pe2$$ = {
          Rational[1, 5], 
          Rational[1, 4]}, $CellContext`progress$$ = 
        0, $CellContext`ps1$$ = {
          Rational[3, 4], 
          Rational[1, 2]}, $CellContext`ps2$$ = {
          Rational[2, 3], 
          Rational[1, 4]}}, "ControllerVariables" :> {
        Hold[$CellContext`progress$$, $CellContext`progress$15179$$, 0], 
        Hold[$CellContext`ps1$$, $CellContext`ps1$15180$$, {0, 0}], 
        Hold[$CellContext`ps2$$, $CellContext`ps2$15181$$, {0, 0}], 
        Hold[$CellContext`pe1$$, $CellContext`pe1$15182$$, {0, 0}], 
        Hold[$CellContext`pe2$$, $CellContext`pe2$15183$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`path$, $CellContext`pm1$, $CellContext`pm2$, \
$CellContext`mv$, $CellContext`\[CapitalDelta]xy$, $CellContext`path1$, \
$CellContext`path2$}, $CellContext`path$ = \
$CellContext`achieveDesiredYspacing[$CellContext`ps1$$, $CellContext`ps2$$, \
$CellContext`pe1$$, $CellContext`pe2$$]; Graphics[{Black, 
           Rectangle[(-0.1) {1, 1}, 1.1 {1, 1}], White, 
           Rectangle[{0, 0}, {1, 1}], 
           PointSize[Large], Green, 
           Point[$CellContext`ps1$$], 
           Circle[$CellContext`ps2$$, 1/20], Red, 
           Point[$CellContext`pe1$$], 
           Circle[$CellContext`pe2$$, 1/20], Blue, {Dashed, 
            Line[{$CellContext`ps1$$, $CellContext`pe1$$}], 
            
            Line[{$CellContext`ps2$$, $CellContext`pe2$$}]}, \
$CellContext`desired\[CapitalDelta]x = (Part[$CellContext`pe1$$, 1] - 
              Part[$CellContext`ps1$$, 1]) - (Part[$CellContext`pe2$$, 1] - 
             Part[$CellContext`ps2$$, 1]); 
           Text[$CellContext`desired\[CapitalDelta]x, {0, 0}], Magenta, 
           Text[$CellContext`path$, {0, 0.5}], 
           Arrow[
            
            Accumulate[$CellContext`path$]], $CellContext`\[CapitalDelta]xy$ = \
{0, 0}; $CellContext`pm1$ = $CellContext`ps1$$; $CellContext`pm2$ = \
$CellContext`ps2$$; $CellContext`path1$ = {$CellContext`pm1$}; \
$CellContext`path2$ = {$CellContext`pm2$}; 
           For[$CellContext`i = 
             1, $CellContext`i <= $CellContext`progress$$ (
               Length[$CellContext`path$] - 1), 
             Increment[$CellContext`i], $CellContext`mv$ = 
              Part[$CellContext`path$, $CellContext`i + 
                1]; $CellContext`pm1$ = \
$CellContext`moveParticleInWalls[$CellContext`pm1$, $CellContext`mv$]; \
$CellContext`pm2$ = $CellContext`moveParticleInWalls[$CellContext`pm2$, \
$CellContext`mv$]; AppendTo[$CellContext`path1$, $CellContext`pm1$]; 
             AppendTo[$CellContext`path2$, $CellContext`pm2$]; $CellContext`\
\[CapitalDelta]xy$ = $CellContext`\[CapitalDelta]xy$ + $CellContext`mv$]; 
           If[$CellContext`i < 
             Length[$CellContext`path$], $CellContext`mv$ = 
              FractionalPart[$CellContext`progress$$ (
                  Length[$CellContext`path$] - 1)] 
               Part[$CellContext`path$, 2 + 
                 Floor[$CellContext`progress$$ (Length[$CellContext`path$] - 
                    1)]]; $CellContext`\[CapitalDelta]xy$ = $CellContext`\
\[CapitalDelta]xy$ + $CellContext`mv$; 
             Line[{$CellContext`mv$, $CellContext`\[CapitalDelta]xy$ + \
$CellContext`mv$}]; $CellContext`pm1$ = \
$CellContext`moveParticleInWalls[$CellContext`pm1$, $CellContext`mv$]; \
$CellContext`pm2$ = $CellContext`moveParticleInWalls[$CellContext`pm2$, \
$CellContext`mv$]; AppendTo[$CellContext`path1$, $CellContext`pm1$]; 
             AppendTo[$CellContext`path2$, $CellContext`pm2$]; Null]; 
           Point[$CellContext`\[CapitalDelta]xy$], Blue, 
           Point[{$CellContext`pm1$}], 
           Circle[$CellContext`pm2$, 1/20], 
           Arrow[$CellContext`path1$], 
           Arrow[$CellContext`path2$]}]], 
      "Specifications" :> {{$CellContext`progress$$, 0, 1, ControlType -> 
         Slider, Appearance -> "Labeled"}, {{$CellContext`ps1$$, {
           Rational[3, 4], 
           Rational[1, 2]}}, {-1, -1}, {1, 1}, ControlType -> 
         Locator}, {{$CellContext`ps2$$, {
           Rational[2, 3], 
           Rational[1, 4]}}, {-1, -1}, {1, 1}, ControlType -> 
         Locator}, {{$CellContext`pe1$$, {
           Rational[1, 4], 
           Rational[1, 2]}}, {-1, -1}, {1, 1}, ControlType -> 
         Locator}, {{$CellContext`pe2$$, {
           Rational[1, 5], 
           Rational[1, 4]}}, {-1, -1}, {1, 1}, ControlType -> Locator}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{411., {167., 172.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.6452085981552477`*^9, 3.6452086156143723`*^9}, 
   3.6452105743098307`*^9, 3.6452760944624968`*^9, 3.645276357480023*^9, {
   3.6495020703840714`*^9, 3.649502070798826*^9}, 3.649507530198319*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.643719828080661*^9, 3.6437198302210283`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"TODO", ":", " ", 
        RowBox[{
        "Correct", " ", "this", " ", "part", " ", "of", " ", "the", " ", 
         "code", " ", "for", " ", "doing", " ", "the", " ", "right", " ", 
         "move", "\[IndentingNewLine]", "1"}]}], ")"}], "X", " ", 
      "coordinate", "\[IndentingNewLine]", "2"}], ")"}], "Y", " ", "and", " ",
     "X", " ", 
    RowBox[{"together", "."}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"achieveDesiredXspacing2", "[", 
     RowBox[{"ps1_", ",", "ps2_", ",", "pe1_", ",", "pe2_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "moves", ",", "\[IndentingNewLine]", "currPosTop", ",", 
        "currPosBottom", ",", "dir", ",", "Ydest", ",", "\[CapitalDelta]xy", 
        ",", "distPossibleToMove", ",", "\[IndentingNewLine]", 
        "desired\[CapitalDelta]x"}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"desired\[CapitalDelta]x", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "pe1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
           RowBox[{
           "ps1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ")"}], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "pe2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
           RowBox[{
           "ps2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"moves", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "determine", " ", "which", " ", "point", " ", "is", " ", "highest"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
          
          RowBox[{
          "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ",", "  ", 
         RowBox[{
          RowBox[{"currPosTop", " ", "=", " ", "ps1"}], ";", " ", 
          RowBox[{"currPosBottom", "=", "ps2"}], ";"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"currPosTop", " ", "=", " ", "ps2"}], ";", " ", 
          RowBox[{"currPosBottom", "=", "ps1"}], ";", 
          RowBox[{"desired\[CapitalDelta]x", "=", 
           RowBox[{"-", "desired\[CapitalDelta]x"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"desired\[CapitalDelta]x", "\[Equal]", "0"}], ",", " ", 
         RowBox[{"Return", "[", "moves", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"dir", " ", "=", " ", 
        RowBox[{"Sign", "[", "desired\[CapitalDelta]x", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"gives", " ", "a", " ", "sequnce", " ", "of", " ", 
         RowBox[{"moves", ":", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[CapitalDelta]x", "1"], ",", 
               SubscriptBox["\[CapitalDelta]y", "1"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[CapitalDelta]x", "2"], ",", 
               SubscriptBox["\[CapitalDelta]y", "2"]}], "}"}], ",", "...", 
             ",", 
             RowBox[{"{", 
              RowBox[{
               SubscriptBox["\[CapitalDelta]x", "n"], ",", 
               SubscriptBox["\[CapitalDelta]y", "n"]}], "}"}]}], "}"}], " ", 
           "that", " ", "should", " ", "be"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Ydest", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"1", "-", 
             RowBox[{
             "currPosTop", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], " ", "]"}], " ", "<", " ", 
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"-", "1"}], "-", " ", 
             RowBox[{
             "currPosBottom", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], " ", "]"}]}], " ", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"move", " ", "to", " ", "top"}], ",", " ", 
         RowBox[{
         "then", " ", "drag", " ", "along", " ", "top", " ", "edge"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[CapitalDelta]xy", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"dir", "*", "1"}], ",", "Ydest"}], "}"}], "-", 
         "currPosTop"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"moves", ",", "\[CapitalDelta]xy"}], " ", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currPosTop", " ", "=", " ", 
        RowBox[{"currPosTop", "+", "\[CapitalDelta]xy"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"currPosBottom", " ", "=", " ", 
        RowBox[{"currPosTop", "+", "\[CapitalDelta]xy"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"moves", ",", 
         RowBox[{"{", 
          RowBox[{"desired\[CapitalDelta]x", ",", "0"}], "}"}]}], " ", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"move", " ", "to", " ", "bottom"}], ",", " ", 
         RowBox[{
         "then", " ", "drag", " ", "along", " ", "bottom", " ", "edge"}]}], 
        "*)"}], "\[IndentingNewLine]", "moves"}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.642117005887888*^9, 3.64211704486712*^9}, {
   3.642117080685493*^9, 3.642117217297338*^9}, {3.642117260448121*^9, 
   3.642117305018765*^9}, {3.642117511615287*^9, 3.642117633054521*^9}, {
   3.6421177418781223`*^9, 3.6421178504686604`*^9}, {3.642117887646315*^9, 
   3.642118041825981*^9}, {3.642119570474946*^9, 3.64211960046413*^9}, {
   3.6421224299242067`*^9, 3.642122626178296*^9}, {3.6421226577702293`*^9, 
   3.642122658927763*^9}, {3.64212270589599*^9, 3.642122770037375*^9}, {
   3.642122816936406*^9, 3.6421228540995893`*^9}, {3.642122887902849*^9, 
   3.642123134147615*^9}, {3.642123202432761*^9, 3.6421232238840103`*^9}, {
   3.642123346657174*^9, 3.642123377521241*^9}, {3.642123428706773*^9, 
   3.642123448075632*^9}, {3.6421234859031773`*^9, 3.642123490125963*^9}, {
   3.642123529946437*^9, 3.642123614193193*^9}, {3.642123680352056*^9, 
   3.642123819206952*^9}, {3.6421238602522697`*^9, 3.6421242032488956`*^9}, 
   3.6421245018997107`*^9, {3.642124553649888*^9, 3.642124570521325*^9}, {
   3.6421249864059467`*^9, 3.642124998158658*^9}, {3.642125036405294*^9, 
   3.64212504324365*^9}, {3.6421251078426847`*^9, 3.642125140697101*^9}, {
   3.642125343186297*^9, 3.642125384296021*^9}, {3.6421255624871492`*^9, 
   3.642125573200697*^9}, {3.642125624390115*^9, 3.642125650157194*^9}, {
   3.6421256836120777`*^9, 3.6421257183628807`*^9}, {3.642125749174429*^9, 
   3.6421257532941713`*^9}, {3.642125809836959*^9, 3.64212581142803*^9}, {
   3.642125882836829*^9, 3.6421258855791197`*^9}, {3.642126087913125*^9, 
   3.642126109423635*^9}, {3.6421261565550413`*^9, 3.642126162449119*^9}, {
   3.643637850723421*^9, 3.64363786052169*^9}, {3.6436382381629*^9, 
   3.643638262771618*^9}, {3.6436390442359056`*^9, 3.643639084904951*^9}, {
   3.643639121969161*^9, 3.643639157946107*^9}, {3.643639395068747*^9, 
   3.643639409529407*^9}, {3.64408388838693*^9, 3.644083936023664*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"achieveDesiredXspacing", "[", 
    RowBox[{"ps1_", ",", "ps2_", ",", "pe1_", ",", "pe2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\[CapitalDelta]e", " ", ",", " ", "\[CapitalDelta]x", " ", ",", " ", 
       "L", " ", ",", "\[IndentingNewLine]", "currPosTop", ",", " ", 
       "currPosBottom", ",", "\[CapitalDelta]r", ",", " ", "moves", ",", " ", 
       "endPosTop", ",", " ", "endPosBottom"}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "determine", " ", "which", " ", "point", " ", "is", " ", "highest"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
         "ps1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ">", 
         RowBox[{
         "ps2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",",
         "  ", 
        RowBox[{
         RowBox[{"currPosTop", " ", "=", " ", "ps1"}], ";", " ", 
         RowBox[{"currPosBottom", "=", "ps2"}], ";", 
         RowBox[{"endPosTop", " ", "=", " ", "pe1"}], ";", " ", 
         RowBox[{"endPosBottom", "=", " ", "pe2"}], ";"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"currPosTop", " ", "=", " ", "ps2"}], ";", " ", 
         RowBox[{"currPosBottom", "=", "ps1"}], ";", " ", 
         RowBox[{"endPosTop", " ", "=", " ", "pe2"}], ";", " ", 
         RowBox[{"endPosBottom", "=", " ", "pe1"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]e", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "endPosTop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "-", 
        RowBox[{
        "endPosBottom", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]x", " ", "=", " ", 
       RowBox[{
        RowBox[{
        "currPosTop", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        " ", "-", " ", 
        RowBox[{
        "currPosBottom", "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"moves", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"L", "=", " ", "1"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"\[CapitalDelta]x", "\[Equal]", "\[CapitalDelta]e"}], ",", 
        " ", 
        RowBox[{"Return", "[", "moves", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"L", "-", 
          RowBox[{
          "currPosBottom", "\[LeftDoubleBracket]", "1", 
           "\[RightDoubleBracket]"}]}], " ", "<", " ", "\[CapitalDelta]e"}], 
        ",", "  ", 
        RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"L", "-", "\[CapitalDelta]e", " ", "-", " ", 
            RowBox[{
            "currPosBottom", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ",", " ", "0"}], "}"}]}], ",", " ", 
        
        RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", " ", ",", " ", "\[CapitalDelta]r"}], " ", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currPosTop", " ", "=", " ", 
       RowBox[{"currPosTop", "+", "\[CapitalDelta]r"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currPosBottom", " ", "=", " ", 
       RowBox[{"currPosBottom", "+", "\[CapitalDelta]r"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", 
          RowBox[{
          "currPosBottom", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", ",", " ", "\[CapitalDelta]r"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currPosTop", " ", "=", " ", 
       RowBox[{"currPosTop", "+", "\[CapitalDelta]r"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currPosBottom", " ", "=", " ", 
       RowBox[{"currPosBottom", "+", "\[CapitalDelta]r"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"\[CapitalDelta]r", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[CapitalDelta]e", " ", "-", " ", "\[CapitalDelta]x"}], ",",
          "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"moves", ",", " ", "\[CapitalDelta]r"}], " ", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currPosTop", " ", "=", " ", 
       RowBox[{"currPosTop", "+", "\[CapitalDelta]r"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"currPosBottom", " ", "=", " ", 
       RowBox[{"currPosBottom", "+", "\[CapitalDelta]r"}]}], ";", 
      "\[IndentingNewLine]", "moves"}]}], "\[IndentingNewLine]", "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.6440839710159693`*^9, 3.644084092665428*^9}, {
   3.6440841297336197`*^9, 3.644084273035254*^9}, {3.644084339330164*^9, 
   3.6440843806157846`*^9}, {3.6440846214704723`*^9, 3.644084849465185*^9}, {
   3.644084917608593*^9, 3.644084946351903*^9}, {3.6440849964469976`*^9, 
   3.644085363555134*^9}, {3.64408539913411*^9, 3.644085551755156*^9}, 
   3.644132596565523*^9, {3.644132676425064*^9, 3.644132716713914*^9}, {
   3.6441502731161537`*^9, 3.6441502943616047`*^9}, {3.644150325284739*^9, 
   3.644150384228251*^9}, {3.644150459493541*^9, 3.6441504599962482`*^9}, {
   3.644151003649124*^9, 3.644151007142168*^9}, 3.644151044576947*^9, {
   3.644154740568837*^9, 3.6441547437102547`*^9}}],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.6440839460165987`*^9, 3.644083955710146*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Sign", "[", 
  RowBox[{"-", "3.6"}], "]"}]], "Input",
 CellChangeTimes->{{3.642122516293871*^9, 3.6421225196497297`*^9}}],

Cell[BoxData[
 RowBox[{"-", "1"}]], "Output",
 CellChangeTimes->{3.645208598303627*^9, 3.645210574480154*^9, 
  3.645276094594221*^9, 3.645276357601837*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ps1", " ", "=", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ps2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], ",", 
       RowBox[{"1", "/", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pe1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"3", "/", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pe2", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "/", "2"}], ",", 
       RowBox[{"3", "/", "4"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"Black", ",", " ", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"1.1", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], ",", 
        RowBox[{"1.1", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", "White", ",", " ", 
      RowBox[{"Rectangle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"PointSize", "[", "Large", "]"}], ",", "\[IndentingNewLine]", 
      "Green", ",", 
      RowBox[{"Point", "@", "ps1"}], ",", 
      RowBox[{"Circle", "[", 
       RowBox[{"ps2", ",", 
        RowBox[{"1", "/", "20"}]}], "]"}], ",", "\[IndentingNewLine]", "Red", 
      ",", 
      RowBox[{"Point", "@", "pe1"}], ",", 
      RowBox[{"Circle", "[", 
       RowBox[{"pe2", ",", 
        RowBox[{"1", "/", "20"}]}], "]"}], ",", "\[IndentingNewLine]", "Blue",
       ",", 
      RowBox[{"{", " ", 
       RowBox[{"Dashed", ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"ps1", ",", "pe1"}], "}"}], "]"}], ",", 
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"ps2", ",", "pe2"}], "}"}], "]"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"desired\[CapitalDelta]x", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "pe1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
           RowBox[{
           "ps1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ")"}], "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "pe2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
           RowBox[{
           "ps2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ")"}]}]}], ";"}]}], "\[IndentingNewLine]", "}"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"achieveDesiredXspacing", "[", 
    RowBox[{"ps1", ",", "ps2", ",", "pe1", ",", "pe2"}], "]"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.642125177938827*^9, 3.642125194232583*^9}, {
  3.642125728761321*^9, 3.642125737031479*^9}, {3.642125958876588*^9, 
  3.6421260501401033`*^9}}],

Cell[BoxData[
 GraphicsBox[{
   {GrayLevel[0], RectangleBox[{-1.1, -1.1}, {1.1, 1.1}]}, 
   {GrayLevel[1], RectangleBox[{-1, -1}, {1, 1}]}, 
   {RGBColor[0, 1, 0], PointSize[Large], 
    PointBox[NCache[{Rational[1, 2], Rational[1, 4]}, {0.5, 0.25}]], 
    CircleBox[NCache[{Rational[-1, 2], Rational[1, 4]}, {-0.5, 0.25}], NCache[
     Rational[1, 20], 0.05]], 
    {RGBColor[1, 0, 0], 
     PointBox[NCache[{Rational[1, 2], Rational[3, 4]}, {0.5, 0.75}]], 
     CircleBox[NCache[{Rational[1, 2], Rational[3, 4]}, {0.5, 0.75}], NCache[
      Rational[1, 20], 0.05]]}, 
    {RGBColor[0, 0, 1], 
     {Dashing[{Small, Small}], 
      LineBox[NCache[{{Rational[1, 2], Rational[1, 4]}, {
         Rational[1, 2], Rational[3, 4]}}, {{0.5, 0.25}, {0.5, 0.75}}]], 
      LineBox[NCache[{{Rational[-1, 2], Rational[1, 4]}, {
         Rational[1, 2], Rational[3, 4]}}, {{-0.5, 0.25}, {0.5, 
        0.75}}]]}}}}]], "Output",
 CellChangeTimes->{3.645208598328047*^9, 3.645210574530272*^9, 
  3.645276094636169*^9, 3.645276357649062*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["501", "1000"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "4"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["999", "1000"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "1000"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["999", "1000"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", "1000"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["999", "1000"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", "1000"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], ",", 
     FractionBox["749", "1000"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.645208598328047*^9, 3.645210574530272*^9, 
  3.645276094636169*^9, 3.645276357655704*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 694},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September 9, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 566, 14, 46, "Input"],
Cell[1127, 36, 231, 5, 46, "Input"],
Cell[CellGroupData[{
Cell[1383, 45, 133, 1, 44, "Subsection"],
Cell[1519, 48, 490, 12, 163, "Text"],
Cell[CellGroupData[{
Cell[2034, 64, 552, 17, 68, "Input"],
Cell[2589, 83, 434, 14, 47, "Output"],
Cell[3026, 99, 146, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3209, 106, 632, 21, 28, "Input"],
Cell[3844, 129, 143, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4024, 136, 519, 11, 28, "Input"],
Cell[4546, 149, 1549, 46, 76, "Output"]
}, Open  ]],
Cell[6110, 198, 14280, 350, 835, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[20415, 552, 668, 19, 28, "Input"],
Cell[21086, 573, 205, 4, 28, "Output"]
}, Open  ]],
Cell[21306, 580, 20503, 451, 1168, "Input"],
Cell[41812, 1033, 10978, 251, 777, "Input"],
Cell[52793, 1286, 22228, 489, 1406, "Input"],
Cell[CellGroupData[{
Cell[75046, 1779, 386, 12, 28, "Input"],
Cell[75435, 1793, 160, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75632, 1800, 22834, 522, 1134, "Input",
 InitializationCell->True],
Cell[98469, 2324, 6898, 135, 390, "Output"]
}, Open  ]],
Cell[105382, 2462, 94, 1, 28, "Input"],
Cell[105479, 2465, 8164, 179, 557, "Input",
 InitializationCell->True],
Cell[113646, 2646, 6074, 137, 488, "Input"],
Cell[119723, 2785, 113, 1, 46, "Input"],
Cell[CellGroupData[{
Cell[119861, 2790, 145, 3, 28, "Input"],
Cell[120009, 2795, 156, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[120202, 2803, 3362, 95, 284, "Input"],
Cell[123567, 2900, 1027, 20, 374, "Output"],
Cell[124597, 2922, 1116, 38, 48, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
